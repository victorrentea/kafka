@startuml
title Atomic Consume + SQL
hide footbox
skinparam monochrome reverse
queue B
participant C
database DB

'B->C: M
'C->INBOX: insert M
'C->B: Ack M
alt CDC
    B->INBOX:M
end

group transaction
    Poller->INBOX: select M
    INBOX->DB: update(s)
    Poller->API!!: call API
    Poller->INBOX: delete M
end

@enduml
? inbox pattern
